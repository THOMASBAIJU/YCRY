{% extends "base.html" %}

{% block content %}
<div class="max-w-7xl mx-auto min-h-[80vh] flex items-center justify-center py-10">
    
    <div class="grid lg:grid-cols-5 gap-0 w-full bg-white/60 backdrop-blur-xl rounded-[2.5rem] shadow-2xl overflow-hidden border border-white/50" data-aos="fade-up">
        
        <!-- Form Section (Left - 3 cols) -->
        <div class="lg:col-span-3 p-8 md:p-12 relative">
            <div class="max-w-xl mx-auto">
                <div class="mb-10">
                    <h1 class="text-4xl font-display font-extrabold text-warm-dark mb-2">Join the Family üß∏</h1>
                    <p class="text-warm-gray">Start your journey with YCRY today. Tell us about you and your little one.</p>
                </div>

                <form method="POST" enctype="multipart/form-data" class="space-y-6" id="regForm">
                    
                    <!-- STEP 1: Guardian (Shown Initially) -->
                    <div id="step-1" class="transition-all duration-300 ease-in-out">
                        <div class="relative bg-white/50 p-8 rounded-[2rem] border border-white/60 shadow-sm transition hover:shadow-md">
                            <h2 class="text-xl font-bold text-warm-teal mb-6 flex items-center gap-2">
                                <span class="w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center text-sm">1</span>
                                Parent / Guardian
                            </h2>
                            
                            <div class="grid md:grid-cols-2 gap-6">
                                <div class="col-span-2">
                                    <label for="caregiver_name" class="label-premium">Full Name</label>
                                    <input type="text" name="caregiver_name" id="caregiver_name" class="input-premium" placeholder="Jane Doe" required>
                                </div>
                                <div>
                                    <label for="username" class="label-premium">Username</label>
                                    <input type="text" name="username" id="username" class="input-premium" placeholder="janedoe" minlength="4" required>
                                </div>
                                <div>
                                    <label for="password" class="label-premium">Password</label>
                                    <input type="password" name="password" id="password" class="input-premium" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" minlength="6" required>
                                </div>
                            </div>
                        </div>

                        <div class="mt-8 flex justify-end">
                            <button type="button" onclick="showStep(2)" class="w-full btn-primary bg-warm-teal hover:bg-teal-600 border-none text-white py-4 text-xl shadow-lg hover:shadow-warm-teal/50 transition-all rounded-2xl flex items-center justify-center gap-2">
                                Next Step
                            </button>
                        </div>
                    </div>

                    <!-- STEP 2: Baby (Hidden Initially) -->
                    <div id="step-2" class="hidden transition-all duration-300 ease-in-out">
                        <div class="relative bg-white/50 p-8 rounded-[2rem] border border-white/60 shadow-sm transition hover:shadow-md">
                            <h2 class="text-xl font-bold text-warm-coral mb-6 flex items-center gap-2">
                                <span class="w-8 h-8 rounded-full bg-red-100 flex items-center justify-center text-sm">2</span>
                                Baby's Details
                            </h2>
                            
                            <div class="grid md:grid-cols-2 gap-6">
                                <div class="col-span-2">
                                    <label for="baby_name" class="label-premium">Baby's Name</label>
                                    <input type="text" name="baby_name" class="input-premium" placeholder="Baby Doe" required>
                                </div>
                                
                                <div>
                                    <label for="dob" class="label-premium">Date of Birth</label>
                                    <input type="date" name="dob" class="input-premium" required>
                                </div>
                                
                                <div>
                                    <label class="label-premium">Gender</label>
                                    <div class="flex gap-4">
                                        <label class="cursor-pointer">
                                            <input type="radio" name="gender" value="Male" class="peer sr-only" required>
                                            <div class="px-6 py-3 rounded-xl bg-white border-2 border-transparent peer-checked:border-blue-400 peer-checked:bg-blue-50 text-gray-500 peer-checked:text-blue-600 font-bold transition">
                                                Boy üíô
                                            </div>
                                        </label>
                                        <label class="cursor-pointer">
                                            <input type="radio" name="gender" value="Female" class="peer sr-only" required>
                                            <div class="px-6 py-3 rounded-xl bg-white border-2 border-transparent peer-checked:border-pink-400 peer-checked:bg-pink-50 text-gray-500 peer-checked:text-pink-600 font-bold transition">
                                                Girl ü©∑
                                            </div>
                                        </label>
                                    </div>
                                </div>
                                
                                <div>
                                    <label for="blood_group" class="label-premium">Blood Group</label>
                                    <select name="blood_group" class="input-premium appearance-none" required>
                                        <option value="" disabled selected>Select Group</option>
                                        <option value="A+">A+</option>
                                        <option value="A-">A-</option>
                                        <option value="B+">B+</option>
                                        <option value="B-">B-</option>
                                        <option value="O+">O+</option>
                                        <option value="O-">O-</option>
                                        <option value="AB+">AB+</option>
                                        <option value="AB-">AB-</option>
                                    </select>
                                </div>

                                <div>
                                    <label for="profile_pic" class="label-premium">Photo (Optional)</label>
                                    <input type="file" name="profile_pic" class="input-premium text-sm file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-warm-teal file:text-white hover:file:bg-warm-dark">
                                </div>
                            </div>

                            <!-- Vitals -->
                            <div class="mt-6 pt-6 border-t border-gray-100">
                                 <h3 class="text-sm font-bold text-warm-gray uppercase tracking-widest mb-4">Birth Vitals</h3>
                                 <div class="grid grid-cols-2 md:grid-cols-5 gap-4">
                                    <div>
                                        <label class="label-premium text-xs">Weight (kg)</label>
                                        <input type="number" step="0.1" min="0.5" max="10" name="weight" class="input-premium px-2 py-2 text-center" placeholder="3.5" required>
                                    </div>
                                    <div>
                                        <label class="label-premium text-xs">Height (cm)</label>
                                        <input type="number" step="0.1" min="20" max="80" name="height" class="input-premium px-2 py-2 text-center" placeholder="50" required>
                                    </div>
                                    <div>
                                        <label class="label-premium text-xs">Head (cm)</label>
                                        <input type="number" step="0.1" min="20" max="60" name="head_circ" class="input-premium px-2 py-2 text-center" placeholder="35">
                                    </div>
                                    <div>
                                        <label class="label-premium text-xs">Chest (cm)</label>
                                        <input type="number" step="0.1" min="20" max="60" name="chest_circ" class="input-premium px-2 py-2 text-center" placeholder="33">
                                    </div>
                                    <div>
                                        <label class="label-premium text-xs">Apgar</label>
                                        <input type="number" step="1" min="0" max="10" name="apgar" class="input-premium px-2 py-2 text-center" placeholder="9">
                                    </div>
                                 </div>
                            </div>
                        </div>

                        <div class="mt-8 flex gap-4">
                            <button type="button" onclick="showStep(1)" class="btn-secondary border-2 border-gray-200 text-gray-500 hover:border-warm-teal hover:text-warm-teal hover:bg-transparent px-8 rounded-2xl transition-all">
                                Back
                            </button>
                            <button type="submit" class="btn-primary flex-[2] bg-warm-coral hover:bg-red-400 border-none text-white py-4 text-xl shadow-lg hover:shadow-warm-coral/50 rounded-2xl flex items-center justify-center gap-2">
                                Create Family Profile
                            </button>
                        </div>
                    </div>
                    
                    <p class="text-center text-warm-gray text-sm">
                        Already have an account? <a href="/login" class="font-bold text-warm-teal hover:underline">Log In</a>
                    </p>
                </form>
                
                <script>
                    function showStep(step) {
                        const step1 = document.getElementById('step-1');
                        const step2 = document.getElementById('step-2');
                        const name = document.getElementById('caregiver_name');
                        const user = document.getElementById('username');
                        const pass = document.getElementById('password');

                        if (step === 2) {
                            // Simple Validation for Step 1
                            if (!name.value || !user.value || !pass.value) {
                                showToast("Please fill in all Parent details first!", 'error');
                                return;
                            }
                            if (user.value.length < 4) {
                                showToast("Username must be at least 4 characters.", 'error');
                                return;
                            }
                            if (pass.value.length < 6) {
                                showToast("Password must be at least 6 characters.", 'error');
                                return;
                            }

                            step1.classList.add('hidden');
                            step2.classList.remove('hidden');
                            step2.classList.add('reveal'); // Trigger animation
                        } else {
                            step2.classList.add('hidden');
                            step1.classList.remove('hidden');
                            step1.classList.add('reveal');
                        }
                    }
                </script>
            </div>
        </div>

        <!-- Image Section (Right - 2 cols) -->
        <div class="lg:col-span-2 relative hidden lg:block h-full">
            <img src="{{ url_for('static', filename='images/register_side.png') }}" 
                 alt="Sleeping Baby" 
                 class="absolute inset-0 w-full h-full object-cover">
             <div class="absolute inset-0 bg-warm-coral/80 mix-blend-multiply"></div>
             <!-- Floating Elements -->
             <div class="absolute top-1/4 -left-12 card-warm p-4 flex items-center gap-3 animate-float shadow-xl">
                 <span class="text-2xl">üí§</span>
                 <div>
                     <p class="font-bold text-sm">Sleep Tracking</p>
                     <p class="text-xs text-warm-gray">coming soon</p>
                 </div>
             </div>
             
             <div class="absolute bottom-1/3 -right-6 card-warm p-4 flex items-center gap-3 animate-float-delayed shadow-xl">
                 <span class="text-2xl">üìè</span>
                 <div>
                     <p class="font-bold text-sm">Growth Analysis</p>
                     <p class="text-xs text-warm-gray">AI Powered</p>
                 </div>
             </div>
        </div>

    </div>

</div>
{% endblock %}